<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hola Mundo con D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
</head>
<body>
    <h1>Visualización de JSON con D3.js</h1>
    <p>Lectura de datos desde un archivo JSON.</p>

    <!-- SVG para visualizar datos -->
    <svg id="jsonDemo" width="400" height="400" style="border: 1px solid black;"></svg>

    <script>
    // Define la función para visualizar datos en el SVG
    function drawText(selector, data) {
        const svg = d3.select(selector);
        // Elimina cualquier texto existente
        svg.selectAll("text").remove();
        
        // Agrega texto para cada elemento del JSON
        svg.selectAll("text")
          .data(data) // Vincula los datos al SVG
          .enter() // Crea nuevos elementos de texto
          .append("text")
          .attr("x", 10) // Posición horizontal
          .attr("y", (d, i) => (i + 1) * 20) // Posición vertical (20px entre líneas)
          .text(d => d.id + ": " + d.value); // Muestra id y valor
    }

    // Carga el archivo JSON y muestra datos en el SVG
    d3.json("./test.json") // Reemplaza con la ruta correcta al archivo JSON
      .then(function(data) {
        console.log("Datos leídos:", data); // Para verificar datos en la consola

        drawText("#jsonDemo", data); // Muestra datos en el SVG
      })
      .catch(function(error) {
        console.error("Error al cargar el JSON:", error); // Captura errores al cargar JSON
      });
    </script>

<h1>Visualización de datos BNA</h1>
<p>Lectura de límites geográficos desde un archivo BNA.</p>

<!-- SVG para visualizar datos -->
<svg id="bnaDemo" width="400" height="400" style="border: 1px solid black;"></svg>

<script>
// Carga el archivo BNA como texto
d3.text("/.states_usa.bna") // Reemplaza con la ruta al archivo BNA
  .then(function(data) {
    // Divide el contenido por líneas
    const lines = data.split("\n");

    // Filtra las líneas que contienen datos de coordenadas
    const coordinates = lines
      .map(line => line.trim())
      .filter(line => line.match(/-?\d+(\.\d+)?/)) // Solo líneas con números (coordenadas)
      .map(line => {
        const parts = line.split(",").map(Number); // Divide por coma y convierte a números
        return { x: parts[0], y: parts[1] }; // Extrae las coordenadas X, Y
      });

    // Crear un grupo para las líneas de límites
    const svg = d3.select("#bnaDemo");
    const path = d3.path();

    // Dibuja las líneas en el SVG
    path.moveTo(coordinates[0].x, coordinates[0].y); // Inicia desde la primera coordenada

    coordinates.forEach(coord => {
      path.lineTo(coord.x, coord.y); // Dibuja líneas entre puntos
    });

    svg.append("path")
      .attr("d", path.toString()) // Asigna el camino (path)
      .attr("stroke", "black") // Color de línea
      .attr("fill", "none"); // No rellenar
  })
  .catch(function(error) {
    console.error("Error al cargar el archivo BNA:", error);
  });
</script>
</body>

</html>

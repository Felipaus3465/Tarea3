<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hola Mundo con D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
</head>
<body>
    <h1>Hola Mundo</h1>
    <p>Este es un ejemplo que utiliza D3.js para mostrar datos de un archivo JSON.</p>

    <!-- Aumenta el tamaño del SVG para más espacio -->
    <svg id="jsonDemo" width="300" height="200" style="border: 1px solid black;"></svg>

    <!-- Define la función drawText antes de usarla -->
    <script>
    function drawText(id, data) {
        const svg = d3.select(id);
        svg.selectAll("text") // Elimina texto existente
          .data(data)
          .enter()
          .append("text")
          .attr("x", 10) // Posiciona el texto
          .attr("y", (d, i) => (i + 1) * 20) // Espaciado entre líneas
          .text(d => {
            // Asegura que el objeto tiene las propiedades necesarias
            if (d.letter && d.number && d.color) {
              return `${d.letter} ${d.number} ${d.color}`;
            } else {
              return "Datos incompletos";
            }
          });
    }

    // Leer el JSON y manejar errores
    d3.json("./test.json")
      .then(function(data) {
        console.log("Datos leídos:", data);

        // Convierte a arreglo si es necesario
        if (!Array.isArray(data)) {
          data = Object.values(data); // Convierte objeto a arreglo
        }

        // Llama a la función para mostrar datos en el SVG
        drawText("#jsonDemo", data);
      })
      .catch(function(error) {
        console.error("Error al cargar el JSON:", error);
      });
    </script>
</body>

</html>
